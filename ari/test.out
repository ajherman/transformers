/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
Token indices sequence length is longer than the specified maximum sequence length for this model (287644 > 1024). Running this sequence through the model will result in indexing errors
  0%|          | 0/281 [00:00<?, ?it/s]  0%|          | 1/281 [00:00<00:39,  7.10it/s]  1%|▏         | 4/281 [00:00<00:15, 17.68it/s]  2%|▏         | 7/281 [00:00<00:12, 21.90it/s]  4%|▎         | 10/281 [00:00<00:11, 24.09it/s]  5%|▍         | 13/281 [00:00<00:10, 25.35it/s]  6%|▌         | 16/281 [00:00<00:10, 26.12it/s]  7%|▋         | 19/281 [00:00<00:09, 26.63it/s]  8%|▊         | 22/281 [00:00<00:09, 26.97it/s]  9%|▉         | 25/281 [00:01<00:09, 26.81it/s] 10%|▉         | 28/281 [00:01<00:09, 27.06it/s] 11%|█         | 31/281 [00:01<00:09, 27.24it/s] 12%|█▏        | 34/281 [00:01<00:09, 27.38it/s] 13%|█▎        | 37/281 [00:01<00:08, 27.47it/s] 14%|█▍        | 40/281 [00:01<00:08, 27.54it/s] 15%|█▌        | 43/281 [00:01<00:08, 27.56it/s] 16%|█▋        | 46/281 [00:01<00:08, 27.58it/s] 17%|█▋        | 49/281 [00:01<00:08, 27.55it/s] 19%|█▊        | 52/281 [00:01<00:08, 27.59it/s] 20%|█▉        | 55/281 [00:02<00:08, 27.63it/s] 21%|██        | 58/281 [00:02<00:08, 27.65it/s] 22%|██▏       | 61/281 [00:02<00:07, 27.68it/s] 23%|██▎       | 64/281 [00:02<00:07, 27.68it/s] 24%|██▍       | 67/281 [00:02<00:07, 27.70it/s] 25%|██▍       | 70/281 [00:02<00:07, 27.69it/s] 26%|██▌       | 73/281 [00:02<00:07, 27.67it/s] 27%|██▋       | 76/281 [00:02<00:07, 27.68it/s] 28%|██▊       | 79/281 [00:02<00:07, 27.68it/s] 29%|██▉       | 82/281 [00:03<00:07, 27.68it/s] 30%|███       | 85/281 [00:03<00:07, 27.67it/s] 31%|███▏      | 88/281 [00:03<00:06, 27.67it/s] 32%|███▏      | 91/281 [00:03<00:06, 27.69it/s] 33%|███▎      | 94/281 [00:03<00:06, 27.65it/s] 35%|███▍      | 97/281 [00:03<00:06, 27.65it/s] 36%|███▌      | 100/281 [00:03<00:06, 27.04it/s] 37%|███▋      | 103/281 [00:03<00:06, 27.16it/s] 38%|███▊      | 106/281 [00:03<00:06, 27.25it/s] 39%|███▉      | 109/281 [00:04<00:06, 27.34it/s] 40%|███▉      | 112/281 [00:04<00:06, 27.35it/s] 41%|████      | 115/281 [00:04<00:06, 27.41it/s] 42%|████▏     | 118/281 [00:04<00:05, 27.43it/s] 43%|████▎     | 121/281 [00:04<00:05, 27.46it/s] 44%|████▍     | 124/281 [00:04<00:05, 27.48it/s] 45%|████▌     | 127/281 [00:04<00:05, 27.49it/s] 46%|████▋     | 130/281 [00:04<00:05, 27.48it/s] 47%|████▋     | 133/281 [00:04<00:05, 27.52it/s] 48%|████▊     | 136/281 [00:05<00:05, 27.32it/s] 49%|████▉     | 139/281 [00:05<00:05, 27.41it/s] 51%|█████     | 142/281 [00:05<00:05, 27.47it/s] 52%|█████▏    | 145/281 [00:05<00:04, 27.50it/s] 53%|█████▎    | 148/281 [00:05<00:04, 27.54it/s] 54%|█████▎    | 151/281 [00:05<00:04, 27.55it/s] 55%|█████▍    | 154/281 [00:05<00:04, 27.58it/s] 56%|█████▌    | 157/281 [00:05<00:04, 27.58it/s] 57%|█████▋    | 160/281 [00:05<00:04, 27.59it/s] 58%|█████▊    | 163/281 [00:06<00:04, 27.56it/s] 59%|█████▉    | 166/281 [00:06<00:04, 27.57it/s] 60%|██████    | 169/281 [00:06<00:04, 27.58it/s] 61%|██████    | 172/281 [00:06<00:03, 27.59it/s] 62%|██████▏   | 175/281 [00:06<00:03, 27.11it/s] 63%|██████▎   | 178/281 [00:06<00:03, 27.25it/s] 64%|██████▍   | 181/281 [00:06<00:03, 27.33it/s] 65%|██████▌   | 184/281 [00:06<00:03, 27.41it/s] 67%|██████▋   | 187/281 [00:06<00:03, 27.46it/s] 68%|██████▊   | 190/281 [00:07<00:03, 27.51it/s] 69%|██████▊   | 193/281 [00:07<00:03, 27.53it/s] 70%|██████▉   | 196/281 [00:07<00:03, 27.56it/s] 71%|███████   | 199/281 [00:07<00:02, 27.57it/s] 72%|███████▏  | 202/281 [00:07<00:02, 27.55it/s] 73%|███████▎  | 205/281 [00:07<00:02, 27.57it/s] 74%|███████▍  | 208/281 [00:07<00:02, 27.58it/s] 75%|███████▌  | 211/281 [00:07<00:02, 27.58it/s] 76%|███████▌  | 214/281 [00:07<00:02, 27.60it/s] 77%|███████▋  | 217/281 [00:07<00:02, 27.59it/s] 78%|███████▊  | 220/281 [00:08<00:02, 27.60it/s] 79%|███████▉  | 223/281 [00:08<00:02, 27.60it/s] 80%|████████  | 226/281 [00:08<00:01, 27.60it/s] 81%|████████▏ | 229/281 [00:08<00:01, 27.60it/s] 83%|████████▎ | 232/281 [00:08<00:01, 27.59it/s] 84%|████████▎ | 235/281 [00:08<00:01, 27.58it/s] 85%|████████▍ | 238/281 [00:08<00:01, 27.58it/s] 86%|████████▌ | 241/281 [00:08<00:01, 27.59it/s] 87%|████████▋ | 244/281 [00:08<00:01, 27.58it/s] 88%|████████▊ | 247/281 [00:09<00:01, 27.57it/s] 89%|████████▉ | 250/281 [00:09<00:01, 27.53it/s] 90%|█████████ | 253/281 [00:09<00:01, 27.54it/s] 91%|█████████ | 256/281 [00:09<00:00, 27.55it/s] 92%|█████████▏| 259/281 [00:09<00:00, 27.55it/s] 93%|█████████▎| 262/281 [00:09<00:00, 27.55it/s] 94%|█████████▍| 265/281 [00:09<00:00, 27.55it/s] 95%|█████████▌| 268/281 [00:09<00:00, 27.57it/s] 96%|█████████▋| 271/281 [00:09<00:00, 27.56it/s] 98%|█████████▊| 274/281 [00:10<00:00, 27.54it/s] 99%|█████████▊| 277/281 [00:10<00:00, 27.54it/s]100%|█████████▉| 280/281 [00:10<00:00, 27.56it/s]100%|█████████▉| 280/281 [00:10<00:00, 27.16it/s]
Perplexity:  tensor(29.9394, device='cuda:0')
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
778
488
876
1194
628
803
1757
992
1541
336
91
1451
2257
1183
1151
922
1937
1584
921
1996
894
1262
1646
1868
1560
1690
1791
942
840
1020
462
215
96
826
978
1761
854
1669
1077
938
1235
1404
1579
333
904
1054
894
966
1116
1661
2713
762
1079
143
149
1794
1555
1699
584
1007
1273
926
538
747
477
475
204
268
838
1058
1732
1830
1093
249
579
638
1309
1837
1842
1522
740
1372
1207
1832
889
1300
778
427
458
840
1628
1676
471
462
1371
1574
1566
1315
1307
1508
1342
1500
602
651
482
522
762
576
821
1274
1940
1550
2015
369
1052
662
2442
1127
1735
1158
1836
833
505
123
133
125
145
128
139
197
340
829
364
182
381
821
1702
1424
1044
1057
1299
985
1020
3375
1168
1143
1259
1145
2552
3240
1533
729
974
1213
1017
1298
1003
921
1742
132
801
1036
1603
1256
2625
1745
2937
2024
1008
1943
1358
1391
1448
966
769
878
1062
988
951
920
825
1210
893
872
552
683
659
1676
1839
566
715
305
1313
1068
552
778
921
616
478
1256
409
799
1346
740
690
624
2006
1466
1738
894
1317
870
609
654
787
672
1329
1279
583
650
1034
894
407
929
344
579
1485
1052
886
794
762
1065
795
1136
1163
690
600
80
181
1207
634
900
854
1481
1357
950
825
1353
510
379
900
988
1399
674
743
170
294
675
1244
915
1313
852
859
524
758
1087
1237
1541
204
1276
1268
823
569
Traceback (most recent call last):
  File "/vast/home/ajherman/transformers/ari/test.py", line 101, in <module>
    dist.all_reduce(torch.tensor(all_losses), op=dist.ReduceOp.SUM)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 72, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 1992, in all_reduce
    work = group.allreduce([tensor], opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: No backend type associated with device type cpu
[2024-06-18 01:59:57,083] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 2437522) of binary: /vast/home/ajherman/miniconda3/envs/transformer/bin/python
Traceback (most recent call last):
  File "/vast/home/ajherman/miniconda3/envs/transformer/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==2.0.1', 'console_scripts', 'torchrun')())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
test.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-06-18_01:59:57
  host      : cn4071
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2437522)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
