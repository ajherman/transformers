[2024-06-19 13:16:13,376] torch.distributed.run: [WARNING] 
[2024-06-19 13:16:13,376] torch.distributed.run: [WARNING] *****************************************
[2024-06-19 13:16:13,376] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-06-19 13:16:13,376] torch.distributed.run: [WARNING] *****************************************
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
Config:
 GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.2",
  "use_cache": true,
  "vocab_size": 50257
}

Number of model parameters: 124439808
Config:
 GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_inner": null,
  "n_layer": 12,
  "n_positions": 1024,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.2",
  "use_cache": true,
  "vocab_size": 50257
}

Number of model parameters: 124439808
The JSON loader parameter `block_size` is deprecated. Please use `chunksize` instead
The JSON loader parameter `block_size` is deprecated. Please use `chunksize` instead
Finished loading datasets
Finished loading datasets
Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1875.38 examples/s]Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1845.88 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1858.28 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1845.52 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1903.10 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1898.39 examples/s]Map: 100%|██████████| 3760/3760 [00:01<00:00, 1940.70 examples/s]Map: 100%|██████████| 3760/3760 [00:02<00:00, 1877.32 examples/s]
Map: 100%|██████████| 3760/3760 [00:01<00:00, 1926.96 examples/s]Map: 100%|██████████| 3760/3760 [00:02<00:00, 1834.89 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
max_steps is given, it will override any value given in num_train_epochs
cn656:2808738:2808738 [0] NCCL INFO Bootstrap : Using eth0:192.168.100.144<0>
cn656:2808738:2808738 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
cn656:2808738:2808738 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.19.3+cuda12.3
cn656:2808739:2808739 [1] NCCL INFO cudaDriverVersion 12040
cn656:2808739:2808739 [1] NCCL INFO Bootstrap : Using eth0:192.168.100.144<0>
cn656:2808739:2808739 [1] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
cn656:2808738:2808819 [0] NCCL INFO NET/IB : No device found.
cn656:2808738:2808819 [0] NCCL INFO NET/Socket : Using [0]eth0:192.168.100.144<0>
cn656:2808738:2808819 [0] NCCL INFO Using non-device net plugin version 0
cn656:2808738:2808819 [0] NCCL INFO Using network Socket
cn656:2808739:2808820 [1] NCCL INFO NET/IB : No device found.
cn656:2808739:2808820 [1] NCCL INFO NET/Socket : Using [0]eth0:192.168.100.144<0>
cn656:2808739:2808820 [1] NCCL INFO Using non-device net plugin version 0
cn656:2808739:2808820 [1] NCCL INFO Using network Socket
cn656:2808739:2808820 [1] NCCL INFO comm 0xa31e500 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId d8000 commId 0xf07aaedab03872fd - Init START
cn656:2808738:2808819 [0] NCCL INFO comm 0xcb20bc0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 86000 commId 0xf07aaedab03872fd - Init START
cn656:2808739:2808820 [1] NCCL INFO Setting affinity for GPU 1 to ffff,f00000ff,fff00000
cn656:2808738:2808819 [0] NCCL INFO Setting affinity for GPU 0 to ffff,f00000ff,fff00000
cn656:2808739:2808820 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
cn656:2808738:2808819 [0] NCCL INFO Channel 00/02 :    0   1
cn656:2808739:2808820 [1] NCCL INFO P2P Chunksize set to 131072
cn656:2808738:2808819 [0] NCCL INFO Channel 01/02 :    0   1
cn656:2808738:2808819 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
cn656:2808738:2808819 [0] NCCL INFO P2P Chunksize set to 131072
cn656:2808738:2808819 [0] NCCL INFO Channel 00 : 0[0] -> 1[1] via SHM/direct/direct
cn656:2808739:2808820 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
cn656:2808738:2808819 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
cn656:2808739:2808820 [1] NCCL INFO Channel 01 : 1[1] -> 0[0] via SHM/direct/direct
cn656:2808738:2808819 [0] NCCL INFO Connected all rings
cn656:2808738:2808819 [0] NCCL INFO Connected all trees
cn656:2808739:2808820 [1] NCCL INFO Connected all rings
cn656:2808739:2808820 [1] NCCL INFO Connected all trees
cn656:2808739:2808820 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
cn656:2808739:2808820 [1] NCCL INFO 2 coll channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
cn656:2808738:2808819 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
cn656:2808738:2808819 [0] NCCL INFO 2 coll channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
cn656:2808739:2808820 [1] NCCL INFO comm 0xa31e500 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId d8000 commId 0xf07aaedab03872fd - Init COMPLETE
cn656:2808738:2808819 [0] NCCL INFO comm 0xcb20bc0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 86000 commId 0xf07aaedab03872fd - Init COMPLETE
Time per epoch:  0.5398569981257121 m
Time per epoch:  0.5398581306139628 m
{'train_runtime': 20.8636, 'train_samples_per_second': 19.939, 'train_steps_per_second': 0.048, 'train_loss': 3.3292410373687744, 'epoch': 1.0}
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:20<00:00, 20.82s/it]                                             100%|██████████| 1/1 [00:20<00:00, 20.82s/it]100%|██████████| 1/1 [00:20<00:00, 20.86s/it]
  0%|          | 0/235 [00:00<?, ?it/s]  1%|          | 2/235 [00:00<00:23,  9.87it/s]  1%|▏         | 3/235 [00:00<00:33,  6.96it/s]  2%|▏         | 4/235 [00:00<00:38,  6.04it/s]  2%|▏         | 5/235 [00:00<00:41,  5.61it/s]  3%|▎         | 6/235 [00:01<00:42,  5.36it/s]  3%|▎         | 7/235 [00:01<00:43,  5.21it/s]  3%|▎         | 8/235 [00:01<00:44,  5.12it/s]  4%|▍         | 9/235 [00:01<00:44,  5.05it/s]  4%|▍         | 10/235 [00:01<00:44,  5.01it/s]  5%|▍         | 11/235 [00:02<00:44,  4.98it/s]  5%|▌         | 12/235 [00:02<00:44,  4.96it/s]  6%|▌         | 13/235 [00:02<00:44,  4.95it/s]  6%|▌         | 14/235 [00:02<00:44,  4.94it/s]  6%|▋         | 15/235 [00:02<00:44,  4.94it/s]  7%|▋         | 16/235 [00:03<00:44,  4.93it/s]  7%|▋         | 17/235 [00:03<00:44,  4.93it/s]  8%|▊         | 18/235 [00:03<00:44,  4.92it/s]  8%|▊         | 19/235 [00:03<00:43,  4.92it/s]  9%|▊         | 20/235 [00:03<00:43,  4.92it/s]  9%|▉         | 21/235 [00:04<00:43,  4.92it/s]  9%|▉         | 22/235 [00:04<00:43,  4.92it/s] 10%|▉         | 23/235 [00:04<00:43,  4.92it/s] 10%|█         | 24/235 [00:04<00:42,  4.92it/s] 11%|█         | 25/235 [00:04<00:42,  4.92it/s] 11%|█         | 26/235 [00:05<00:42,  4.92it/s] 11%|█▏        | 27/235 [00:05<00:42,  4.92it/s] 12%|█▏        | 28/235 [00:05<00:42,  4.92it/s] 12%|█▏        | 29/235 [00:05<00:41,  4.92it/s] 13%|█▎        | 30/235 [00:05<00:41,  4.92it/s] 13%|█▎        | 31/235 [00:06<00:41,  4.92it/s] 14%|█▎        | 32/235 [00:06<00:41,  4.92it/s] 14%|█▍        | 33/235 [00:06<00:41,  4.92it/s] 14%|█▍        | 34/235 [00:06<00:40,  4.92it/s] 15%|█▍        | 35/235 [00:06<00:40,  4.92it/s] 15%|█▌        | 36/235 [00:07<00:40,  4.92it/s] 16%|█▌        | 37/235 [00:07<00:40,  4.92it/s] 16%|█▌        | 38/235 [00:07<00:40,  4.92it/s] 17%|█▋        | 39/235 [00:07<00:39,  4.92it/s] 17%|█▋        | 40/235 [00:07<00:39,  4.92it/s] 17%|█▋        | 41/235 [00:08<00:39,  4.92it/s] 18%|█▊        | 42/235 [00:08<00:39,  4.92it/s] 18%|█▊        | 43/235 [00:08<00:39,  4.92it/s] 19%|█▊        | 44/235 [00:08<00:38,  4.92it/s] 19%|█▉        | 45/235 [00:08<00:38,  4.92it/s] 20%|█▉        | 46/235 [00:09<00:38,  4.92it/s] 20%|██        | 47/235 [00:09<00:38,  4.92it/s] 20%|██        | 48/235 [00:09<00:38,  4.92it/s] 21%|██        | 49/235 [00:09<00:37,  4.92it/s] 21%|██▏       | 50/235 [00:09<00:37,  4.92it/s] 22%|██▏       | 51/235 [00:10<00:37,  4.91it/s] 22%|██▏       | 52/235 [00:10<00:37,  4.91it/s] 23%|██▎       | 53/235 [00:10<00:37,  4.92it/s] 23%|██▎       | 54/235 [00:10<00:36,  4.92it/s] 23%|██▎       | 55/235 [00:10<00:36,  4.92it/s] 24%|██▍       | 56/235 [00:11<00:36,  4.92it/s] 24%|██▍       | 57/235 [00:11<00:36,  4.92it/s] 25%|██▍       | 58/235 [00:11<00:35,  4.92it/s] 25%|██▌       | 59/235 [00:11<00:35,  4.92it/s] 26%|██▌       | 60/235 [00:11<00:35,  4.92it/s] 26%|██▌       | 61/235 [00:12<00:35,  4.92it/s] 26%|██▋       | 62/235 [00:12<00:35,  4.92it/s] 27%|██▋       | 63/235 [00:12<00:34,  4.92it/s] 27%|██▋       | 64/235 [00:12<00:34,  4.92it/s] 28%|██▊       | 65/235 [00:13<00:34,  4.92it/s] 28%|██▊       | 66/235 [00:13<00:34,  4.92it/s] 29%|██▊       | 67/235 [00:13<00:34,  4.92it/s] 29%|██▉       | 68/235 [00:13<00:33,  4.92it/s] 29%|██▉       | 69/235 [00:13<00:33,  4.92it/s] 30%|██▉       | 70/235 [00:14<00:33,  4.92it/s] 30%|███       | 71/235 [00:14<00:33,  4.92it/s] 31%|███       | 72/235 [00:14<00:33,  4.92it/s] 31%|███       | 73/235 [00:14<00:32,  4.92it/s] 31%|███▏      | 74/235 [00:14<00:32,  4.92it/s] 32%|███▏      | 75/235 [00:15<00:32,  4.91it/s] 32%|███▏      | 76/235 [00:15<00:32,  4.92it/s] 33%|███▎      | 77/235 [00:15<00:32,  4.92it/s] 33%|███▎      | 78/235 [00:15<00:31,  4.92it/s] 34%|███▎      | 79/235 [00:15<00:31,  4.92it/s] 34%|███▍      | 80/235 [00:16<00:31,  4.92it/s] 34%|███▍      | 81/235 [00:16<00:31,  4.92it/s] 35%|███▍      | 82/235 [00:16<00:31,  4.92it/s] 35%|███▌      | 83/235 [00:16<00:30,  4.92it/s] 36%|███▌      | 84/235 [00:16<00:30,  4.93it/s] 36%|███▌      | 85/235 [00:17<00:30,  4.93it/s] 37%|███▋      | 86/235 [00:17<00:30,  4.92it/s] 37%|███▋      | 87/235 [00:17<00:30,  4.92it/s] 37%|███▋      | 88/235 [00:17<00:29,  4.92it/s] 38%|███▊      | 89/235 [00:17<00:29,  4.92it/s] 38%|███▊      | 90/235 [00:18<00:29,  4.92it/s] 39%|███▊      | 91/235 [00:18<00:29,  4.92it/s] 39%|███▉      | 92/235 [00:18<00:29,  4.92it/s] 40%|███▉      | 93/235 [00:18<00:28,  4.92it/s] 40%|████      | 94/235 [00:18<00:28,  4.92it/s] 40%|████      | 95/235 [00:19<00:28,  4.92it/s] 41%|████      | 96/235 [00:19<00:28,  4.93it/s] 41%|████▏     | 97/235 [00:19<00:28,  4.93it/s] 42%|████▏     | 98/235 [00:19<00:27,  4.93it/s] 42%|████▏     | 99/235 [00:19<00:27,  4.93it/s] 43%|████▎     | 100/235 [00:20<00:27,  4.93it/s] 43%|████▎     | 101/235 [00:20<00:27,  4.92it/s] 43%|████▎     | 102/235 [00:20<00:27,  4.92it/s] 44%|████▍     | 103/235 [00:20<00:26,  4.92it/s] 44%|████▍     | 104/235 [00:20<00:26,  4.92it/s] 45%|████▍     | 105/235 [00:21<00:26,  4.92it/s] 45%|████▌     | 106/235 [00:21<00:26,  4.92it/s] 46%|████▌     | 107/235 [00:21<00:26,  4.92it/s] 46%|████▌     | 108/235 [00:21<00:25,  4.92it/s] 46%|████▋     | 109/235 [00:21<00:25,  4.93it/s] 47%|████▋     | 110/235 [00:22<00:25,  4.92it/s] 47%|████▋     | 111/235 [00:22<00:25,  4.92it/s] 48%|████▊     | 112/235 [00:22<00:24,  4.92it/s] 48%|████▊     | 113/235 [00:22<00:24,  4.92it/s] 49%|████▊     | 114/235 [00:22<00:24,  4.92it/s] 49%|████▉     | 115/235 [00:23<00:24,  4.92it/s] 49%|████▉     | 116/235 [00:23<00:24,  4.92it/s] 50%|████▉     | 117/235 [00:23<00:23,  4.92it/s] 50%|█████     | 118/235 [00:23<00:23,  4.92it/s] 51%|█████     | 119/235 [00:23<00:23,  4.92it/s] 51%|█████     | 120/235 [00:24<00:23,  4.92it/s] 51%|█████▏    | 121/235 [00:24<00:23,  4.92it/s] 52%|█████▏    | 122/235 [00:24<00:22,  4.92it/s] 52%|█████▏    | 123/235 [00:24<00:22,  4.92it/s] 53%|█████▎    | 124/235 [00:24<00:22,  4.92it/s] 53%|█████▎    | 125/235 [00:25<00:22,  4.92it/s] 54%|█████▎    | 126/235 [00:25<00:22,  4.92it/s] 54%|█████▍    | 127/235 [00:25<00:21,  4.92it/s] 54%|█████▍    | 128/235 [00:25<00:21,  4.92it/s] 55%|█████▍    | 129/235 [00:26<00:21,  4.92it/s] 55%|█████▌    | 130/235 [00:26<00:21,  4.92it/s] 56%|█████▌    | 131/235 [00:26<00:21,  4.91it/s] 56%|█████▌    | 132/235 [00:26<00:20,  4.91it/s] 57%|█████▋    | 133/235 [00:26<00:20,  4.92it/s] 57%|█████▋    | 134/235 [00:27<00:20,  4.92it/s] 57%|█████▋    | 135/235 [00:27<00:20,  4.92it/s] 58%|█████▊    | 136/235 [00:27<00:20,  4.92it/s] 58%|█████▊    | 137/235 [00:27<00:19,  4.92it/s] 59%|█████▊    | 138/235 [00:27<00:19,  4.92it/s] 59%|█████▉    | 139/235 [00:28<00:19,  4.93it/s] 60%|█████▉    | 140/235 [00:28<00:19,  4.92it/s] 60%|██████    | 141/235 [00:28<00:19,  4.92it/s] 60%|██████    | 142/235 [00:28<00:18,  4.92it/s] 61%|██████    | 143/235 [00:28<00:18,  4.92it/s] 61%|██████▏   | 144/235 [00:29<00:18,  4.92it/s] 62%|██████▏   | 145/235 [00:29<00:18,  4.92it/s] 62%|██████▏   | 146/235 [00:29<00:18,  4.92it/s] 63%|██████▎   | 147/235 [00:29<00:17,  4.91it/s] 63%|██████▎   | 148/235 [00:29<00:17,  4.92it/s] 63%|██████▎   | 149/235 [00:30<00:17,  4.92it/s] 64%|██████▍   | 150/235 [00:30<00:17,  4.92it/s] 64%|██████▍   | 151/235 [00:30<00:17,  4.92it/s] 65%|██████▍   | 152/235 [00:30<00:16,  4.92it/s] 65%|██████▌   | 153/235 [00:30<00:16,  4.92it/s] 66%|██████▌   | 154/235 [00:31<00:16,  4.92it/s] 66%|██████▌   | 155/235 [00:31<00:16,  4.92it/s] 66%|██████▋   | 156/235 [00:31<00:16,  4.92it/s] 67%|██████▋   | 157/235 [00:31<00:15,  4.92it/s] 67%|██████▋   | 158/235 [00:31<00:15,  4.92it/s] 68%|██████▊   | 159/235 [00:32<00:15,  4.92it/s] 68%|██████▊   | 160/235 [00:32<00:15,  4.92it/s] 69%|██████▊   | 161/235 [00:32<00:15,  4.92it/s] 69%|██████▉   | 162/235 [00:32<00:14,  4.92it/s] 69%|██████▉   | 163/235 [00:32<00:14,  4.92it/s] 70%|██████▉   | 164/235 [00:33<00:14,  4.92it/s] 70%|███████   | 165/235 [00:33<00:14,  4.92it/s] 71%|███████   | 166/235 [00:33<00:14,  4.92it/s] 71%|███████   | 167/235 [00:33<00:13,  4.92it/s] 71%|███████▏  | 168/235 [00:33<00:13,  4.92it/s] 72%|███████▏  | 169/235 [00:34<00:13,  4.92it/s] 72%|███████▏  | 170/235 [00:34<00:13,  4.92it/s] 73%|███████▎  | 171/235 [00:34<00:13,  4.92it/s] 73%|███████▎  | 172/235 [00:34<00:12,  4.92it/s] 74%|███████▎  | 173/235 [00:34<00:12,  4.92it/s] 74%|███████▍  | 174/235 [00:35<00:12,  4.92it/s] 74%|███████▍  | 175/235 [00:35<00:12,  4.92it/s] 75%|███████▍  | 176/235 [00:35<00:11,  4.92it/s] 75%|███████▌  | 177/235 [00:35<00:11,  4.92it/s] 76%|███████▌  | 178/235 [00:35<00:11,  4.91it/s] 76%|███████▌  | 179/235 [00:36<00:11,  4.91it/s] 77%|███████▋  | 180/235 [00:36<00:11,  4.91it/s] 77%|███████▋  | 181/235 [00:36<00:10,  4.92it/s] 77%|███████▋  | 182/235 [00:36<00:10,  4.92it/s] 78%|███████▊  | 183/235 [00:36<00:10,  4.92it/s] 78%|███████▊  | 184/235 [00:37<00:10,  4.92it/s] 79%|███████▊  | 185/235 [00:37<00:10,  4.92it/s] 79%|███████▉  | 186/235 [00:37<00:09,  4.92it/s] 80%|███████▉  | 187/235 [00:37<00:09,  4.92it/s] 80%|████████  | 188/235 [00:37<00:09,  4.92it/s] 80%|████████  | 189/235 [00:38<00:09,  4.92it/s] 81%|████████  | 190/235 [00:38<00:09,  4.92it/s] 81%|████████▏ | 191/235 [00:38<00:08,  4.92it/s] 82%|████████▏ | 192/235 [00:38<00:08,  4.92it/s] 82%|████████▏ | 193/235 [00:39<00:08,  4.92it/s] 83%|████████▎ | 194/235 [00:39<00:08,  4.92it/s] 83%|████████▎ | 195/235 [00:39<00:08,  4.92it/s] 83%|████████▎ | 196/235 [00:39<00:07,  4.92it/s] 84%|████████▍ | 197/235 [00:39<00:07,  4.92it/s] 84%|████████▍ | 198/235 [00:40<00:07,  4.92it/s] 85%|████████▍ | 199/235 [00:40<00:07,  4.92it/s] 85%|████████▌ | 200/235 [00:40<00:07,  4.92it/s] 86%|████████▌ | 201/235 [00:40<00:06,  4.92it/s] 86%|████████▌ | 202/235 [00:40<00:06,  4.92it/s] 86%|████████▋ | 203/235 [00:41<00:06,  4.92it/s] 87%|████████▋ | 204/235 [00:41<00:06,  4.92it/s] 87%|████████▋ | 205/235 [00:41<00:06,  4.92it/s] 88%|████████▊ | 206/235 [00:41<00:05,  4.92it/s] 88%|████████▊ | 207/235 [00:41<00:05,  4.92it/s] 89%|████████▊ | 208/235 [00:42<00:05,  4.92it/s] 89%|████████▉ | 209/235 [00:42<00:05,  4.92it/s] 89%|████████▉ | 210/235 [00:42<00:05,  4.92it/s] 90%|████████▉ | 211/235 [00:42<00:04,  4.92it/s] 90%|█████████ | 212/235 [00:42<00:04,  4.92it/s] 91%|█████████ | 213/235 [00:43<00:04,  4.92it/s] 91%|█████████ | 214/235 [00:43<00:04,  4.92it/s] 91%|█████████▏| 215/235 [00:43<00:04,  4.92it/s] 92%|█████████▏| 216/235 [00:43<00:03,  4.92it/s] 92%|█████████▏| 217/235 [00:43<00:03,  4.92it/s] 93%|█████████▎| 218/235 [00:44<00:03,  4.92it/s] 93%|█████████▎| 219/235 [00:44<00:03,  4.92it/s] 94%|█████████▎| 220/235 [00:44<00:03,  4.92it/s] 94%|█████████▍| 221/235 [00:44<00:02,  4.92it/s] 94%|█████████▍| 222/235 [00:44<00:02,  4.92it/s] 95%|█████████▍| 223/235 [0Evaluation results at step 1:
  eval_loss: 4.1244
  eval_runtime: 47.8855
  eval_samples_per_second: 78.5210
  eval_steps_per_second: 4.9080
  epoch: 1.0000
Loss: 4.12440824508667
Perplexity: 61.831209500375984
0:45<00:02,  4.92it/s] 95%|█████████▌| 224/235 [00:45<00:02,  4.92it/s] 96%|█████████▌| 225/235 [00:45<00:02,  4.92it/s] 96%|█████████▌| 226/235 [00:45<00:01,  4.92it/s] 97%|█████████▋| 227/235 [00:45<00:01,  4.93it/s] 97%|█████████▋| 228/235 [00:46<00:01,  4.93it/s] 97%|█████████▋| 229/235 [00:46<00:01,  4.93it/s] 98%|█████████▊| 230/235 [00:46<00:01,  4.93it/s] 98%|█████████▊| 231/235 [00:46<00:00,  4.93it/s] 99%|█████████▊| 232/235 [00:46<00:00,  4.93it/s] 99%|█████████▉| 233/235 [00:47<00:00,  4.93it/s]100%|█████████▉| 234/235 [00:47<00:00,  4.93it/s]100%|██████████| 235/235 [00:47<00:00,  4.71it/s]100%|██████████| 235/235 [00:47<00:00,  4.94it/s]
Evaluation results at step 1:
  eval_loss: 4.1244
  eval_runtime: 47.8862
  eval_samples_per_second: 78.5200
  eval_steps_per_second: 4.9070
  epoch: 1.0000
Loss: 4.12440824508667
Perplexity: 61.831209500375984
Token indices sequence length is longer than the specified maximum sequence length for this model (287644 > 1024). Running this sequence through the model will result in indexing errors
  0%|          | 0/281 [00:00<?, ?it/s]Token indices sequence length is longer than the specified maximum sequence length for this model (287644 > 1024). Running this sequence through the model will result in indexing errors
  1%|          | 3/281 [00:00<00:09, 28.98it/s]  0%|          | 0/281 [00:00<?, ?it/s]  2%|▏         | 6/281 [00:00<00:09, 29.27it/s]  1%|          | 3/281 [00:00<00:10, 26.99it/s]  3%|▎         | 9/281 [00:00<00:09, 29.39it/s]  2%|▏         | 6/281 [00:00<00:10, 27.24it/s]  4%|▍         | 12/281 [00:00<00:09, 29.44it/s]  3%|▎         | 9/281 [00:00<00:09, 27.34it/s]  5%|▌         | 15/281 [00:00<00:09, 29.49it/s]  4%|▍         | 12/281 [00:00<00:09, 27.39it/s]  6%|▋         | 18/281 [00:00<00:08, 29.52it/s]  5%|▌         | 15/281 [00:00<00:09, 27.41it/s]  7%|▋         | 21/281 [00:00<00:08, 29.54it/s]  6%|▋         | 18/281 [00:00<00:09, 27.39it/s]  9%|▊         | 24/281 [00:00<00:08, 29.51it/s]  7%|▋         | 21/281 [00:00<00:09, 27.38it/s] 10%|▉         | 27/281 [00:00<00:08, 29.51it/s]  9%|▊         | 24/281 [00:00<00:09, 27.42it/s] 11%|█         | 30/281 [00:01<00:08, 29.53it/s] 10%|▉         | 27/281 [00:00<00:09, 27.45it/s] 12%|█▏        | 33/281 [00:01<00:08, 29.55it/s] 11%|█         | 30/281 [00:01<00:09, 27.46it/s] 13%|█▎        | 36/281 [00:01<00:08, 29.55it/s] 12%|█▏        | 33/281 [00:01<00:09, 27.47it/s] 14%|█▍        | 39/281 [00:01<00:08, 29.56it/s] 15%|█▍        | 42/281 [00:01<00:08, 29.55it/s] 13%|█▎        | 36/281 [00:01<00:08, 27.47it/s] 16%|█▌        | 45/281 [00:01<00:07, 29.56it/s] 14%|█▍        | 39/281 [00:01<00:08, 27.47it/s] 17%|█▋        | 48/281 [00:01<00:07, 29.56it/s] 15%|█▍        | 42/281 [00:01<00:08, 27.46it/s] 18%|█▊        | 51/281 [00:01<00:07, 29.56it/s] 16%|█▌        | 45/281 [00:01<00:08, 27.47it/s] 19%|█▉        | 54/281 [00:01<00:07, 29.56it/s] 17%|█▋        | 48/281 [00:01<00:08, 27.47it/s] 20%|██        | 57/281 [00:01<00:07, 29.56it/s] 18%|█▊        | 51/281 [00:01<00:08, 27.48it/s] 21%|██▏       | 60/281 [00:02<00:07, 29.56it/s] 19%|█▉        | 54/281 [00:01<00:08, 27.46it/s] 22%|██▏       | 63/281 [00:02<00:07, 29.55it/s] 20%|██        | 57/281 [00:02<00:08, 27.47it/s] 23%|██▎       | 66/281 [00:02<00:07, 29.56it/s] 21%|██▏       | 60/281 [00:02<00:08, 27.48it/s] 25%|██▍       | 69/281 [00:02<00:07, 29.56it/s] 22%|██▏       | 63/281 [00:02<00:07, 27.47it/s] 26%|██▌       | 72/281 [00:02<00:07, 29.56it/s] 23%|██▎       | 66/281 [00:02<00:07, 27.48it/s] 27%|██▋       | 75/281 [00:02<00:06, 29.56it/s] 25%|██▍       | 69/281 [00:02<00:07, 27.47it/s] 28%|██▊       | 78/281 [00:02<00:06, 29.56it/s] 26%|██▌       | 72/281 [00:02<00:07, 27.48it/s] 29%|██▉       | 81/281 [00:02<00:06, 29.56it/s] 30%|██▉       | 84/281 [00:02<00:06, 29.57it/s] 27%|██▋       | 75/281 [00:02<00:07, 27.40it/s] 31%|███       | 87/281 [00:02<00:06, 29.57it/s] 28%|██▊       | 78/281 [00:02<00:07, 27.43it/s] 32%|███▏      | 90/281 [00:03<00:06, 29.57it/s] 29%|██▉       | 81/281 [00:02<00:07, 27.45it/s] 33%|███▎      | 93/281 [00:03<00:06, 29.57it/s] 30%|██▉       | 84/281 [00:03<00:07, 27.46it/s] 34%|███▍      | 96/281 [00:03<00:06, 29.57it/s] 31%|███       | 87/281 [00:03<00:07, 27.46it/s] 35%|███▌      | 99/281 [00:03<00:06, 29.55it/s] 32%|███▏      | 90/281 [00:03<00:06, 27.46it/s] 36%|███▋      | 102/281 [00:03<00:06, 29.56it/s] 33%|███▎      | 93/281 [00:03<00:06, 27.47it/s] 37%|███▋      | 105/281 [00:03<00:05, 29.56it/s] 34%|███▍      | 96/281 [00:03<00:06, 27.48it/s] 38%|███▊      | 108/281 [00:03<00:05, 29.56it/s] 35%|███▌      | 99/281 [00:03<00:06, 27.48it/s] 40%|███▉      | 111/281 [00:03<00:05, 29.53it/s] 36%|███▋      | 102/281 [00:03<00:06, 27.48it/s] 41%|████      | 114/281 [00:03<00:05, 29.53it/s] 37%|███▋      | 105/281 [00:03<00:06, 27.49it/s] 42%|████▏     | 117/281 [00:03<00:05, 29.54it/s] 38%|███▊      | 108/281 [00:03<00:06, 27.49it/s] 43%|████▎     | 120/281 [00:04<00:05, 29.53it/s] 40%|███▉      | 111/281 [00:04<00:06, 27.46it/s] 44%|████▍     | 123/281 [00:04<00:05, 29.53it/s] 45%|████▍     | 126/281 [00:04<00:05, 29.55it/s] 41%|████      | 114/281 [00:04<00:06, 27.47it/s] 46%|████▌     | 129/281 [00:04<00:05, 29.53it/s] 42%|████▏     | 117/281 [00:04<00:05, 27.46it/s] 47%|████▋     | 132/281 [00:04<00:05, 29.54it/s] 43%|████▎     | 120/281 [00:04<00:05, 27.46it/s] 48%|████▊     | 135/281 [00:04<00:04, 29.54it/s] 44%|████▍     | 123/281 [00:04<00:05, 27.46it/s] 49%|████▉     | 138/281 [00:04<00:04, 29.54it/s] 45%|████▍     | 126/281 [00:04<00:05, 27.47it/s] 50%|█████     | 141/281 [00:04<00:04, 29.51it/s] 46%|████▌     | 129/281 [00:04<00:05, 27.43it/s] 51%|█████     | 144/281 [00:04<00:04, 29.49it/s] 47%|████▋     | 132/281 [00:04<00:05, 27.42it/s] 52%|█████▏    | 147/281 [00:04<00:04, 29.51it/s] 48%|████▊     | 135/281 [00:04<00:05, 27.44it/s] 53%|█████▎    | 150/281 [00:05<00:04, 29.51it/s] 49%|████▉     | 138/281 [00:05<00:05, 27.45it/s] 54%|█████▍    | 153/281 [00:05<00:04, 29.51it/s] 50%|█████     | 141/281 [00:05<00:05, 27.46it/s] 56%|█████▌    | 156/281 [00:05<00:04, 29.52it/s] 51%|█████     | 144/281 [00:05<00:04, 27.47it/s] 57%|█████▋    | 159/281 [00:05<00:04, 29.53it/s] 52%|█████▏    | 147/281 [00:05<00:04, 27.48it/s] 58%|█████▊    | 162/281 [00:05<00:04, 29.54it/s] 53%|█████▎    | 150/281 [00:05<00:04, 27.49it/s] 59%|█████▊    | 165/281 [00:05<00:03, 29.55it/s] 54%|█████▍    | 153/281 [00:05<00:04, 27.49it/s] 60%|█████▉    | 168/281 [00:05<00:03, 29.55it/s] 61%|██████    | 171/281 [00:05<00:03, 29.55it/s] 56%|█████▌    | 156/281 [00:05<00:04, 27.49it/s] 62%|██████▏   | 174/281 [00:05<00:03, 29.53it/s] 57%|█████▋    | 159/281 [00:05<00:04, 27.49it/s] 63%|██████▎   | 177/281 [00:05<00:03, 29.53it/s] 58%|█████▊    | 162/281 [00:05<00:04, 27.48it/s] 64%|██████▍   | 180/281 [00:06<00:03, 29.53it/s] 59%|█████▊    | 165/281 [00:06<00:04, 27.49it/s] 65%|██████▌   | 183/281 [00:06<00:03, 29.53it/s] 60%|█████▉    | 168/281 [00:06<00:04, 27.49it/s] 66%|██████▌   | 186/281 [00:06<00:03, 29.54it/s] 61%|██████    | 171/281 [00:06<00:04, 27.49it/s] 67%|██████▋   | 189/281 [00:06<00:03, 29.54it/s] 62%|██████▏   | 174/281 [00:06<00:03, 27.49it/s] 68%|██████▊   | 192/281 [00:06<00:03, 29.54it/s] 63%|██████▎   | 177/281 [00:06<00:03, 27.48it/s] 69%|██████▉   | 195/281 [00:06<00:02, 29.54it/s] 64%|██████▍   | 180/281 [00:06<00:03, 27.48it/s] 70%|███████   | 198/281 [00:06<00:02, 29.53it/s] 65%|██████▌   | 183/281 [00:06<00:03, 27.16it/s] 72%|███████▏  | 201/281 [00:06<00:02, 29.53it/s] 66%|██████▌   | 186/281 [00:06<00:03, 27.26it/s] 73%|███████▎  | 204/281 [00:06<00:02, 29.52it/s] 67%|██████▋   | 189/281 [00:06<00:03, 27.33it/s] 74%|███████▎  | 207/281 [00:07<00:02, 29.53it/s] 75%|███████▍  | 210/281 [00:07<00:02, 29.54it/s] 68%|██████▊   | 192/281 [00:06<00:03, 27.38it/s] 76%|███████▌  | 213/281 [00:07<00:02, 29.55it/s] 69%|██████▉   | 195/281 [00:07<00:03, 27.40it/s] 77%|███████▋  | 216/281 [00:07<00:02, 29.55it/s] 70%|███████   | 198/281 [00:07<00:03, 27.43it/s] 78%|███████▊  | 219/281 [00:07<00:02, 29.55it/s] 72%|███████▏  | 201/281 [00:07<00:02, 27.43it/s] 79%|███████▉  | 222/281 [00:07<00:01, 29.56it/s] 73%|███████▎  | 204/281 [00:07<00:02, 27.45it/s] 80%|████████  | 225/281 [00:07<00:01, 29.56it/s] 74%|███████▎  | 207/281 [00:07<00:02, 27.45it/s] 81%|████████  | 228/281 [00:07<00:01, 29.55it/s] 75%|███████▍  | 210/281 [00:07<00:02, 27.47it/s] 82%|████████▏ | 231/281 [00:07<00:01, 29.55it/s] 76%|███████▌  | 213/281 [00:07<00:02, 27.48it/s] 83%|████████▎ | 234/281 [00:07<00:01, 29.53it/s] 77%|███████▋  | 216/281 [00:07<00:02, 27.49it/s] 84%|████████▍ | 237/281 [00:08<00:01, 29.54it/s] 78%|███████▊  | 219/281 [00:07<00:02, 27.49it/s] 85%|████████▌ | 240/281 [00:08<00:01, 29.55it/s] 79%|███████▉  | 222/281 [00:08<00:02, 27.49it/s] 86%|████████▋ | 243/281 [00:08<00:01, 29.54it/s] 80%|████████  | 225/281 [00:08<00:02, 27.50it/s] 88%|████████▊ | 246/281 [00:08<00:01, 29.54it/s] 81%|████████  | 228/281 [00:08<00:01, 27.50it/s] 89%|████████▊ | 249/281 [00:08<00:01, 29.55it/s] 82%|████████▏ | 231/281 [00:08<00:01, 27.50it/s] 90%|████████▉ | 252/281 [00:08<00:00, 29.56it/s] 91%|█████████ | 255/281 [00:08<00:00, 29.56it/s] 83%|████████▎ | 234/281 [00:08<00:01, 27.46it/s] 92%|█████████▏| 258/281 [00:08<00:00, 29.54it/s] 84%|████████▍ | 237/281 [00:08<00:01, 27.42it/s] 93%|█████████▎| 261/281 [00:08<00:00, 29.51it/s] 85%|████████▌ | 240/281 [00:08<00:01, 27.40it/s] 94%|█████████▍| 264/281 [00:08<00:00, 29.52it/s] 86%|████████▋ | 243/281 [00:08<00:01, 27.42it/s] 95%|█████████▌| 267/281 [00:09<00:00, 29.53it/s] 88%|████████▊ | 246/281 [00:08<00:01, 27.43it/s] 96%|█████████▌| 270/281 [00:09<00:00, 29.52it/s] 89%|████████▊ | 249/281 [00:09<00:01, 27.44it/s] 97%|█████████▋| 273/281 [00:09<00:00, 29.53it/s] 90%|████████▉ | 252/281 [00:09<00:01, 27.44it/s] 98%|█████████▊| 276/281 [00:09<00:00, 29.53it/s] 91%|█████████ | 255/281 [00:09<00:00, 27.45it/s] 99%|█████████▉| 279/281 [00:09<00:00, 29.53it/s] 92%|█████████▏| 258/281 [00:09<00:00, 27.47it/s]100%|█████████▉| 280/281 [00:09<00:00, 29.42it/s]
Perplexity (single string version):  tensor(29.9473, device='cuda:0')
Evaluation results:
 {'eval_loss': 4.12440824508667, 'eval_runtime': 47.8862, 'eval_samples_per_second': 78.52, 'eval_steps_per_second': 4.907, 'epoch': 1.0}
Perplexity: tensor(61.8312)
Duration:  1.5995768149693808 m
cn656:2808738:2808822 [0] NCCL INFO [Service thread] Connection closed by localRank 0
 93%|█████████▎| 261/281 [00:09<00:00, 27.26it/s] 94%|█████████▍| 264/281 [00:09<00:00, 27.21it/s] 95%|█████████▌| 267/281 [00:09<00:00, 27.15it/s] 96%|█████████▌| 270/281 [00:09<00:00, 27.08it/s] 97%|█████████▋| 273/281 [00:09<00:00, 27.08it/s] 98%|█████████▊| 276/281 [00:10<00:00, 27.18it/s] 99%|█████████▉| 279/281 [00:10<00:00, 27.25it/s]100%|█████████▉| 280/281 [00:10<00:00, 27.32it/s]
Perplexity (single string version):  tensor(29.9473, device='cuda:1')
Evaluation results:
 {'eval_loss': 4.12440824508667, 'eval_runtime': 47.8855, 'eval_samples_per_second': 78.521, 'eval_steps_per_second': 4.908, 'epoch': 1.0}
Perplexity: tensor(61.8312)
Duration:  1.6136610786120096 m
cn656:2808738:2808738 [0] NCCL INFO comm 0xcb20bc0 rank 0 nranks 2 cudaDev 0 busId 86000 - Abort COMPLETE
cn656:2808739:2808821 [1] NCCL INFO [Service thread] Connection closed by localRank 1
cn656:2808739:2808739 [1] NCCL INFO comm 0xa31e500 rank 1 nranks 2 cudaDev 1 busId d8000 - Abort COMPLETE
