[2024-05-23 13:13:01,362] torch.distributed.run: [WARNING] 
[2024-05-23 13:13:01,362] torch.distributed.run: [WARNING] *****************************************
[2024-05-23 13:13:01,362] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-05-23 13:13:01,362] torch.distributed.run: [WARNING] *****************************************
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/vast/home/ajherman/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Config:
 Config:
 Config:
 GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

Config:
 Number of model parameters: 201320
Number of model parameters: 201320
GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

Config:
 Number of model parameters: 201320
GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

Number of model parameters: 201320
Number of model parameters: 201320
Config:
 GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

Number of model parameters: 201320
Config:
 GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

Number of model parameters: 201320
Config:
 GPT2Config {
  "_name_or_path": "gpt2",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 10,
  "n_embd": 4,
  "n_head": 2,
  "n_inner": null,
  "n_layer": 1,
  "n_positions": 10,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 50257
}

Number of model parameters: 201320
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split train, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Found cached dataset wikitext (/vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Constructing Dataset for split validation, from /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Finished loading datasets
Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-c3889beba65c70f2.arrow
Map:   3%|▎         | 1000/36718 [00:00<00:21, 1635.49 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-b4c12c2f3179d8f1.arrow
Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-34ae4d4ad25bb879.arrow
Map:   3%|▎         | 1000/36718 [00:00<00:21, 1645.71 examples/s]Map:   3%|▎         | 1000/36718 [00:00<00:22, 1605.47 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-2b9613a601b6ac1d.arrow
Map:   3%|▎         | 1000/36718 [00:00<00:21, 1651.24 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-1189e49eed046d32.arrow
Map:   3%|▎         | 1000/36718 [00:00<00:21, 1654.14 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-dab9481344d234ce.arrow
Map:   3%|▎         | 1000/36718 [00:00<00:22, 1596.75 examples/s]Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/36718 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   5%|▌         | 2000/36718 [00:01<00:24, 1442.35 examples/s]Map:   5%|▌         | 2000/36718 [00:01<00:24, 1427.89 examples/s]Map:   5%|▌         | 2000/36718 [00:01<00:24, 1420.44 examples/s]Map:   5%|▌         | 2000/36718 [00:01<00:23, 1449.86 examples/s]Map:   5%|▌         | 2000/36718 [00:01<00:23, 1455.32 examples/s]Map:   5%|▌         | 2000/36718 [00:01<00:24, 1421.60 examples/s]Map:   8%|▊         | 3000/36718 [00:01<00:19, 1693.89 examples/s]Map:   8%|▊         | 3000/36718 [00:01<00:19, 1692.68 examples/s]Map:   8%|▊         | 3000/36718 [00:01<00:19, 1693.12 examples/s]Map:   8%|▊         | 3000/36718 [00:01<00:19, 1700.66 examples/s]Map:   8%|▊         | 3000/36718 [00:01<00:19, 1709.12 examples/s]Map:   8%|▊         | 3000/36718 [00:01<00:19, 1689.01 examples/s]Map:  11%|█         | 4000/36718 [00:02<00:17, 1845.24 examples/s]Map:  11%|█         | 4000/36718 [00:02<00:17, 1849.60 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-73cb42e1911e56ec.arrow
Map:  11%|█         | 4000/36718 [00:02<00:17, 1848.24 examples/s]Map:   3%|▎         | 1000/36718 [00:01<00:42, 839.54 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-b304ea9f0c742251.arrow
Map:  11%|█         | 4000/36718 [00:02<00:17, 1851.82 examples/s]Map:   3%|▎         | 1000/36718 [00:01<00:43, 828.77 examples/s]Map:  11%|█         | 4000/36718 [00:02<00:17, 1861.61 examples/s]Map:  11%|█         | 4000/36718 [00:02<00:17, 1839.08 examples/s]Map:  14%|█▎        | 5000/36718 [00:02<00:15, 2035.44 examples/s]Map:  14%|█▎        | 5000/36718 [00:02<00:15, 2037.54 examples/s]Map:  14%|█▎        | 5000/36718 [00:02<00:15, 2030.04 examples/s]Map:  14%|█▎        | 5000/36718 [00:02<00:15, 2040.02 examples/s]Map:  14%|█▎        | 5000/36718 [00:02<00:15, 2050.97 examples/s]Map:  14%|█▎        | 5000/36718 [00:02<00:15, 2023.19 examples/s]Map:  16%|█▋        | 6000/36718 [00:03<00:14, 2173.48 examples/s]Map:  16%|█▋        | 6000/36718 [00:03<00:14, 2183.12 examples/s]Map:  16%|█▋        | 6000/36718 [00:03<00:14, 2170.66 examples/s]Map:  16%|█▋        | 6000/36718 [00:03<00:14, 2185.15 examples/s]Map:  16%|█▋        | 6000/36718 [00:03<00:14, 2187.13 examples/s]Map:  16%|█▋        | 6000/36718 [00:03<00:14, 2148.96 examples/s]Map:  19%|█▉        | 7000/36718 [00:03<00:14, 2091.02 examples/s]Map:  19%|█▉        | 7000/36718 [00:03<00:14, 2106.55 examples/s]Map:  19%|█▉        | 7000/36718 [00:03<00:14, 2091.09 examples/s]Map:  19%|█▉        | 7000/36718 [00:03<00:14, 2107.92 examples/s]Map:   5%|▌         | 2000/36718 [00:02<00:44, 777.37 examples/s]Map:  19%|█▉        | 7000/36718 [00:03<00:14, 2106.35 examples/s]Map:   5%|▌         | 2000/36718 [00:02<00:45, 770.11 examples/s]Map:  19%|█▉        | 7000/36718 [00:03<00:14, 2057.83 examples/s]Map:  22%|██▏       | 8000/36718 [00:04<00:13, 2122.02 examples/s]Map:  22%|██▏       | 8000/36718 [00:04<00:13, 2137.15 examples/s]Map:  22%|██▏       | 8000/36718 [00:04<00:13, 2142.44 examples/s]Map:  22%|██▏       | 8000/36718 [00:04<00:13, 2111.27 examples/s]Map:  22%|██▏       | 8000/36718 [00:04<00:13, 2141.80 examples/s]Map:  22%|██▏       | 8000/36718 [00:04<00:13, 2094.63 examples/s]Map:  25%|██▍       | 9000/36718 [00:04<00:12, 2206.64 examples/s]Map:  25%|██▍       | 9000/36718 [00:04<00:12, 2219.64 examples/s]Map:  25%|██▍       | 9000/36718 [00:04<00:12, 2225.46 examples/s]Map:  25%|██▍       | 9000/36718 [00:04<00:12, 2200.58 examples/s]Map:  25%|██▍       | 9000/36718 [00:04<00:12, 2225.65 examples/s]Map:   8%|▊         | 3000/36718 [00:03<00:37, 906.24 examples/s]Map:   8%|▊         | 3000/36718 [00:03<00:37, 899.65 examples/s]Map:  25%|██▍       | 9000/36718 [00:04<00:12, 2181.13 examples/s]Map:  27%|██▋       | 10000/36718 [00:04<00:11, 2261.77 examples/s]Map:  27%|██▋       | 10000/36718 [00:04<00:11, 2260.89 examples/s]Map:  27%|██▋       | 10000/36718 [00:04<00:11, 2278.27 examples/s]Map:  27%|██▋       | 10000/36718 [00:04<00:11, 2256.87 examples/s]Map:  27%|██▋       | 10000/36718 [00:04<00:11, 2281.05 examples/s]Map:  27%|██▋       | 10000/36718 [00:04<00:11, 2234.99 examples/s]Map:  30%|██▉       | 11000/36718 [00:05<00:11, 2288.90 examples/s]Map:  30%|██▉       | 11000/36718 [00:05<00:11, 2293.74 examples/s]Map:  30%|██▉       | 11000/36718 [00:05<00:11, 2310.19 examples/s]Map:  30%|██▉       | 11000/36718 [00:05<00:11, 2295.92 examples/s]Map:  30%|██▉       | 11000/36718 [00:05<00:11, 2305.63 examples/s]Map:  11%|█         | 4000/36718 [00:04<00:33, 966.89 examples/s]Map:  11%|█         | 4000/36718 [00:04<00:33, 967.00 examples/s]Map:  30%|██▉       | 11000/36718 [00:05<00:11, 2265.91 examples/s]Map:  33%|███▎      | 12000/36718 [00:05<00:10, 2339.95 examples/s]Map:  33%|███▎      | 12000/36718 [00:05<00:10, 2345.65 examples/s]Map:  33%|███▎      | 12000/36718 [00:05<00:10, 2357.34 examples/s]Map:  33%|███▎      | 12000/36718 [00:05<00:10, 2328.09 examples/s]Map:  33%|███▎      | 12000/36718 [00:05<00:10, 2356.39 examples/s]Map:  33%|███▎      | 12000/36718 [00:05<00:10, 2310.83 examples/s]Map:  35%|███▌      | 13000/36718 [00:06<00:10, 2331.46 examples/s]Map:  35%|███▌      | 13000/36718 [00:06<00:10, 2345.29 examples/s]Map:  35%|███▌      | 13000/36718 [00:06<00:10, 2356.69 examples/s]Map:  35%|███▌      | 13000/36718 [00:06<00:10, 2331.65 examples/s]Map:  35%|███▌      | 13000/36718 [00:06<00:10, 2346.62 examples/s]Map:  14%|█▎        | 5000/36718 [00:05<00:29, 1060.33 examples/s]Map:  14%|█▎        | 5000/36718 [00:05<00:29, 1059.94 examples/s]Map:  35%|███▌      | 13000/36718 [00:06<00:10, 2296.09 examples/s]Map:  38%|███▊      | 14000/36718 [00:06<00:09, 2422.28 examples/s]Map:  38%|███▊      | 14000/36718 [00:06<00:09, 2429.98 examples/s]Map:  38%|███▊      | 14000/36718 [00:06<00:09, 2444.97 examples/s]Map:  38%|███▊      | 14000/36718 [00:06<00:09, 2425.07 examples/s]Map:  38%|███▊      | 14000/36718 [00:06<00:09, 2436.25 examples/s]Map:  38%|███▊      | 14000/36718 [00:06<00:09, 2386.75 examples/s]Map:  41%|████      | 15000/36718 [00:06<00:08, 2458.91 examples/s]Map:  41%|████      | 15000/36718 [00:06<00:08, 2467.22 examples/s]Map:  41%|████      | 15000/36718 [00:06<00:08, 2477.15 examples/s]Map:  41%|████      | 15000/36718 [00:06<00:08, 2469.46 examples/s]Map:  41%|████      | 15000/36718 [00:06<00:08, 2476.92 examples/s]Map:  16%|█▋        | 6000/36718 [00:05<00:27, 1127.24 examples/s]Map:  16%|█▋        | 6000/36718 [00:05<00:27, 1126.33 examples/s]Map:  41%|████      | 15000/36718 [00:07<00:08, 2428.99 examples/s]Map:  44%|████▎     | 16000/36718 [00:07<00:08, 2372.08 examples/s]Map:  44%|████▎     | 16000/36718 [00:07<00:08, 2394.37 examples/s]Map:  44%|████▎     | 16000/36718 [00:07<00:08, 2390.34 examples/s]Map:  44%|████▎     | 16000/36718 [00:07<00:08, 2382.99 examples/s]Map:  44%|████▎     | 16000/36718 [00:07<00:08, 2385.46 examples/s]Map:  44%|████▎     | 16000/36718 [00:07<00:08, 2361.89 examples/s]Map:  46%|████▋     | 17000/36718 [00:07<00:08, 2426.49 examples/s]Map:  46%|████▋     | 17000/36718 [00:07<00:08, 2398.79 examples/s]Map:  46%|████▋     | 17000/36718 [00:07<00:08, 2419.22 examples/s]Map:  46%|████▋     | 17000/36718 [00:07<00:08, 2414.53 examples/s]Map:  46%|████▋     | 17000/36718 [00:07<00:08, 2416.90 examples/s]Map:  19%|█▉        | 7000/36718 [00:06<00:27, 1080.34 examples/s]Map:  46%|████▋     | 17000/36718 [00:07<00:08, 2391.57 examples/s]Map:  19%|█▉        | 7000/36718 [00:06<00:27, 1071.00 examples/s]Map:  49%|████▉     | 18000/36718 [00:08<00:07, 2447.72 examples/s]Map:  49%|████▉     | 18000/36718 [00:08<00:07, 2465.62 examples/s]Map:  49%|████▉     | 18000/36718 [00:08<00:07, 2448.27 examples/s]Map:  49%|████▉     | 18000/36718 [00:08<00:07, 2461.94 examples/s]Map:  49%|████▉     | 18000/36718 [00:08<00:07, 2465.02 examples/s]Map:  49%|████▉     | 18000/36718 [00:08<00:07, 2433.32 examples/s]Map:  52%|█████▏    | 19000/36718 [00:08<00:06, 2557.89 examples/s]Map:  52%|█████▏    | 19000/36718 [00:08<00:06, 2538.36 examples/s]Map:  52%|█████▏    | 19000/36718 [00:08<00:06, 2533.72 examples/s]Map:  52%|█████▏    | 19000/36718 [00:08<00:06, 2552.25 examples/s]Map:  52%|█████▏    | 19000/36718 [00:08<00:06, 2555.70 examples/s]Map:  52%|█████▏    | 19000/36718 [00:08<00:07, 2520.67 examples/s]Map:  54%|█████▍    | 20000/36718 [00:08<00:06, 2561.09 examples/s]Map:  54%|█████▍    | 20000/36718 [00:08<00:06, 2545.41 examples/s]Map:  54%|█████▍    | 20000/36718 [00:08<00:06, 2542.53 examples/s]Map:  54%|█████▍    | 20000/36718 [00:08<00:06, 2559.21 examples/s]Map:  22%|██▏       | 8000/36718 [00:07<00:26, 1096.22 examples/s]Map:  54%|█████▍    | 20000/36718 [00:08<00:06, 2560.94 examples/s]Map:  22%|██▏       | 8000/36718 [00:07<00:26, 1086.73 examples/s]Map:  54%|█████▍    | 20000/36718 [00:09<00:06, 2521.86 examples/s]Map:  57%|█████▋    | 21000/36718 [00:09<00:06, 2509.85 examples/s]Map:  57%|█████▋    | 21000/36718 [00:09<00:06, 2494.21 examples/s]Map:  57%|█████▋    | 21000/36718 [00:09<00:06, 2491.60 examples/s]Map:  57%|█████▋    | 21000/36718 [00:09<00:06, 2507.07 examples/s]Map:  57%|█████▋    | 21000/36718 [00:09<00:06, 2509.80 examples/s]Map:  57%|█████▋    | 21000/36718 [00:09<00:06, 2468.04 examples/s]Map:  60%|█████▉    | 22000/36718 [00:09<00:05, 2495.40 examples/s]Map:  60%|█████▉    | 22000/36718 [00:09<00:05, 2475.97 examples/s]Map:  60%|█████▉    | 22000/36718 [00:09<00:05, 2479.88 examples/s]Map:  60%|█████▉    | 22000/36718 [00:09<00:05, 2489.82 examples/s]Map:  25%|██▍       | 9000/36718 [00:08<00:24, 1131.87 examples/s]Map:  25%|██▍       | 9000/36718 [00:08<00:24, 1130.31 examples/s]Map:  60%|█████▉    | 22000/36718 [00:09<00:05, 2493.13 examples/s]Map:  60%|█████▉    | 22000/36718 [00:09<00:05, 2455.29 examples/s]Map:  63%|██████▎   | 23000/36718 [00:10<00:05, 2538.64 examples/s]Map:  63%|██████▎   | 23000/36718 [00:10<00:05, 2517.06 examples/s]Map:  63%|██████▎   | 23000/36718 [00:10<00:05, 2524.16 examples/s]Map:  63%|██████▎   | 23000/36718 [00:10<00:05, 2515.78 examples/s]Map:  63%|██████▎   | 23000/36718 [00:10<00:05, 2536.40 examples/s]Map:  63%|██████▎   | 23000/36718 [00:10<00:05, 2499.21 examples/s]Map:  65%|██████▌   | 24000/36718 [00:10<00:04, 2656.24 examples/s]Map:  65%|██████▌   | 24000/36718 [00:10<00:04, 2634.56 examples/s]Map:  65%|██████▌   | 24000/36718 [00:10<00:04, 2641.94 examples/s]Map:  65%|██████▌   | 24000/36718 [00:10<00:04, 2636.80 examples/s]Map:  65%|██████▌   | 24000/36718 [00:10<00:04, 2652.87 examples/s]Map:  27%|██▋       | 10000/36718 [00:09<00:23, 1159.50 examples/s]Map:  27%|██▋       | 10000/36718 [00:09<00:23, 1156.84 examples/s]Map:  65%|██████▌   | 24000/36718 [00:10<00:04, 2609.04 examples/s]Map:  68%|██████▊   | 25000/36718 [00:10<00:04, 2723.67 examples/s]Map:  68%|██████▊   | 25000/36718 [00:10<00:04, 2704.24 examples/s]Map:  68%|██████▊   | 25000/36718 [00:10<00:04, 2709.65 examples/s]Map:  68%|██████▊   | 25000/36718 [00:10<00:04, 2712.11 examples/s]Map:  68%|██████▊   | 25000/36718 [00:10<00:04, 2722.23 examples/s]Map:  68%|██████▊   | 25000/36718 [00:10<00:04, 2677.23 examples/s]Map:  71%|███████   | 26000/36718 [00:11<00:04, 2669.04 examples/s]Map:  71%|███████   | 26000/36718 [00:11<00:04, 2651.80 examples/s]Map:  71%|███████   | 26000/36718 [00:11<00:04, 2657.97 examples/s]Map:  71%|███████   | 26000/36718 [00:11<00:04, 2661.83 examples/s]Map:  71%|███████   | 26000/36718 [00:11<00:04, 2669.17 examples/s]Map:  30%|██▉       | 11000/36718 [00:10<00:21, 1174.18 examples/s]Map:  30%|██▉       | 11000/36718 [00:10<00:21, 1170.62 examples/s]Map:  71%|███████   | 26000/36718 [00:11<00:04, 2598.71 examples/s]Map:  74%|███████▎  | 27000/36718 [00:11<00:03, 2571.92 examples/s]Map:  74%|███████▎  | 27000/36718 [00:11<00:03, 2562.33 examples/s]Map:  74%|███████▎  | 27000/36718 [00:11<00:03, 2563.31 examples/s]Map:  74%|███████▎  | 27000/36718 [00:11<00:03, 2568.49 examples/s]Map:  74%|███████▎  | 27000/36718 [00:11<00:03, 2574.71 examples/s]Map:  74%|███████▎  | 27000/36718 [00:11<00:03, 2508.04 examples/s]Map:  76%|███████▋  | 28000/36718 [00:11<00:03, 2504.75 examples/s]Map:  76%|███████▋  | 28000/36718 [00:12<00:03, 2494.64 examples/s]Map:  76%|███████▋  | 28000/36718 [00:12<00:03, 2498.42 examples/s]Map:  76%|███████▋  | 28000/36718 [00:12<00:03, 2505.36 examples/s]Map:  76%|███████▋  | 28000/36718 [00:11<00:03, 2489.91 examples/s]Map:  33%|███▎      | 12000/36718 [00:11<00:20, 1198.60 examples/s]Map:  33%|███▎      | 12000/36718 [00:11<00:20, 1194.89 examples/s]Map:  79%|███████▉  | 29000/36718 [00:12<00:02, 2594.07 examples/s]Map:  79%|███████▉  | 29000/36718 [00:12<00:02, 2593.45 examples/s]Map:  79%|███████▉  | 29000/36718 [00:12<00:02, 2605.64 examples/s]Map:  79%|███████▉  | 29000/36718 [00:12<00:02, 2576.03 examples/s]Map:  76%|███████▋  | 28000/36718 [00:12<00:03, 2444.59 examples/s]Map:  79%|███████▉  | 29000/36718 [00:12<00:02, 2588.92 examples/s]Map:  79%|███████▉  | 29000/36718 [00:12<00:03, 2545.60 examples/s]Map:  82%|████████▏ | 30000/36718 [00:12<00:02, 2572.90 examples/s]Map:  82%|████████▏ | 30000/36718 [00:12<00:02, 2588.47 examples/s]Map:  82%|████████▏ | 30000/36718 [00:12<00:02, 2604.81 examples/s]Map:  82%|████████▏ | 30000/36718 [00:12<00:02, 2565.17 examples/s]Map:  82%|████████▏ | 30000/36718 [00:12<00:02, 2589.00 examples/s]Map:  35%|███▌      | 13000/36718 [00:11<00:19, 1194.51 examples/s]Map:  35%|███▌      | 13000/36718 [00:11<00:19, 1189.31 examples/s]Map:  82%|████████▏ | 30000/36718 [00:12<00:02, 2545.16 examples/s]Map:  84%|████████▍ | 31000/36718 [00:13<00:02, 2455.90 examples/s]Map:  84%|████████▍ | 31000/36718 [00:13<00:02, 2466.47 examples/s]Map:  84%|████████▍ | 31000/36718 [00:13<00:02, 2455.72 examples/s]Map:  84%|████████▍ | 31000/36718 [00:13<00:02, 2446.75 examples/s]Map:  84%|████████▍ | 31000/36718 [00:13<00:02, 2468.72 examples/s]Map:  84%|████████▍ | 31000/36718 [00:13<00:02, 2427.34 examples/s]Map:  87%|████████▋ | 32000/36718 [00:13<00:01, 2447.92 examples/s]Map:  87%|████████▋ | 32000/36718 [00:13<00:01, 2451.92 examples/s]Map:  87%|████████▋ | 32000/36718 [00:13<00:01, 2445.99 examples/s]Map:  87%|████████▋ | 32000/36718 [00:13<00:01, 2438.01 examples/s]Map:  87%|████████▋ | 32000/36718 [00:13<00:01, 2457.58 examples/s]Map:  38%|███▊      | 14000/36718 [00:12<00:18, 1240.73 examples/s]Map:  38%|███▊      | 14000/36718 [00:12<00:18, 1234.89 examples/s]Map:  87%|████████▋ | 32000/36718 [00:13<00:01, 2415.39 examples/s]Map:  90%|████████▉ | 33000/36718 [00:14<00:01, 2430.90 examples/s]Map:  90%|████████▉ | 33000/36718 [00:14<00:01, 2431.01 examples/s]Map:  90%|████████▉ | 33000/36718 [00:14<00:01, 2429.89 examples/s]Map:  90%|████████▉ | 33000/36718 [00:14<00:01, 2423.42 examples/s]Map:  90%|████████▉ | 33000/36718 [00:14<00:01, 2437.95 examples/s]Map:  90%|████████▉ | 33000/36718 [00:14<00:01, 2396.82 examples/s]Map:  93%|█████████▎| 34000/36718 [00:14<00:01, 2430.97 examples/s]Map:  93%|█████████▎| 34000/36718 [00:14<00:01, 2430.26 examples/s]Map:  93%|█████████▎| 34000/36718 [00:14<00:01, 2433.70 examples/s]Map:  93%|█████████▎| 34000/36718 [00:14<00:01, 2419.82 examples/s]Map:  41%|████      | 15000/36718 [00:13<00:17, 1262.51 examples/s]Map:  93%|█████████▎| 34000/36718 [00:14<00:01, 2434.57 examples/s]Map:  41%|████      | 15000/36718 [00:13<00:17, 1256.45 examples/s]Map:  95%|█████████▌| 35000/36718 [00:14<00:00, 2513.99 examples/s]Map:  95%|█████████▌| 35000/36718 [00:14<00:00, 2511.79 examples/s]Map:  95%|█████████▌| 35000/36718 [00:14<00:00, 2516.19 examples/s]Map:  95%|█████████▌| 35000/36718 [00:14<00:00, 2503.84 examples/s]Map:  93%|█████████▎| 34000/36718 [00:14<00:01, 2392.57 examples/s]Map:  95%|█████████▌| 35000/36718 [00:14<00:00, 2518.17 examples/s]Map:  95%|█████████▌| 35000/36718 [00:15<00:00, 2474.53 examples/s]Map:  98%|█████████▊| 36000/36718 [00:15<00:00, 2463.44 examples/s]Map:  98%|█████████▊| 36000/36718 [00:15<00:00, 2460.86 examples/s]Map:  98%|█████████▊| 36000/36718 [00:15<00:00, 2468.94 examples/s]Map:  98%|█████████▊| 36000/36718 [00:15<00:00, 2457.23 examples/s]Map:  98%|█████████▊| 36000/36718 [00:15<00:00, 2470.57 examples/s]Map:  44%|████▎     | 16000/36718 [00:14<00:16, 1223.00 examples/s]Map:  44%|████▎     | 16000/36718 [00:14<00:17, 1216.02 examples/s]Map: 100%|██████████| 36718/36718 [00:15<00:00, 2479.57 examples/s]Map: 100%|██████████| 36718/36718 [00:15<00:00, 2478.02 examples/s]Map: 100%|██████████| 36718/36718 [00:15<00:00, 2489.63 examples/s]Done writing 36718 examples in 13191361 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmp2z4ok9pi.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2479.65 examples/s]Done writing 36718 examples in 13191361 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmp_lkzuak8.
Done writing 36718 examples in 13191361 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpifio9aik.
Done writing 36718 examples in 13191361 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmp6dji9z86.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2491.47 examples/s]Done writing 36718 examples in 13191361 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpf5n97l8r.
Finished processing shard number None of 1.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2350.34 examples/s]
Finished processing shard number None of 1.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2345.02 examples/s]
Finished processing shard number None of 1.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2342.61 examples/s]
Finished processing shard number None of 1.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2338.77 examples/s]
Map:  98%|█████████▊| 36000/36718 [00:15<00:00, 2424.52 examples/s]Finished processing shard number None of 1.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2356.19 examples/s]
Map:  46%|████▋     | 17000/36718 [00:14<00:14, 1395.10 examples/s]Map:  46%|████▋     | 17000/36718 [00:14<00:14, 1402.06 examples/s]Map: 100%|██████████| 36718/36718 [00:15<00:00, 2442.63 examples/s]Done writing 36718 examples in 13191361 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpl263bc9s.
Finished processing shard number None of 1.
Map: 100%|██████████| 36718/36718 [00:15<00:00, 2317.06 examples/s]
Map:  49%|████▉     | 18000/36718 [00:15<00:11, 1618.60 examples/s]Map:  49%|████▉     | 18000/36718 [00:15<00:11, 1619.25 examples/s]Map:  52%|█████▏    | 19000/36718 [00:15<00:09, 1851.81 examples/s]Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:  52%|█████▏    | 19000/36718 [00:15<00:09, 1846.92 examples/s]Map:   0%|          | 0/3760 [00:00<?, ? examples/s]Set __getitem__(key) output type to arrow for no columns  (when key is int or slice) and don't output other (un-formatted) columns.
Map:  54%|█████▍    | 20000/36718 [00:15<00:08, 2022.24 examples/s]Map:  54%|█████▍    | 20000/36718 [00:15<00:08, 2013.74 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-b803de4d47ee990e.arrow
Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1808.22 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-e327344faf1f5837.arrow
Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-c3b6164c6378e921.arrow
Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-4c72aaaff53637b0.arrow
Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-9fb9874cee2bc49b.arrow
Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1789.53 examples/s]Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1816.45 examples/s]Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1802.92 examples/s]Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1825.73 examples/s]Map:  57%|█████▋    | 21000/36718 [00:16<00:07, 2123.56 examples/s]Map:  57%|█████▋    | 21000/36718 [00:16<00:07, 2112.82 examples/s]Caching processed dataset at /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-658d18a3f5d16a5f.arrow
Map:  27%|██▋       | 1000/3760 [00:00<00:01, 1822.87 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1763.31 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1793.67 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1780.84 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1783.70 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1790.67 examples/s]Map:  60%|█████▉    | 22000/36718 [00:16<00:06, 2213.75 examples/s]Map:  60%|█████▉    | 22000/36718 [00:16<00:06, 2201.00 examples/s]Map:  53%|█████▎    | 2000/3760 [00:01<00:00, 1781.79 examples/s]Map:  63%|██████▎   | 23000/36718 [00:17<00:05, 2329.13 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1841.97 examples/s]Map:  63%|██████▎   | 23000/36718 [00:17<00:05, 2313.29 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1856.88 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1864.54 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1859.91 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1861.40 examples/s]Map:  65%|██████▌   | 24000/36718 [00:17<00:05, 2490.07 examples/s]Map:  65%|██████▌   | 24000/36718 [00:17<00:05, 2474.31 examples/s]Map: 100%|██████████| 3760/3760 [00:02<00:00, 1919.95 examples/s]Map:  80%|███████▉  | 3000/3760 [00:01<00:00, 1846.31 examples/s]Done writing 3760 examples in 1377368 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpo9wimoiq.
Finished processing shard number None of 1.
Map: 100%|██████████| 3760/3760 [00:02<00:00, 1858.06 examples/s]
/vast/home/ajherman/transformers/src/transformers/training_args.py:1454: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Map: 100%|██████████| 3760/3760 [00:01<00:00, 1938.26 examples/s]Map: 100%|██████████| 3760/3760 [00:01<00:00, 1929.49 examples/s]Map: 100%|██████████| 3760/3760 [00:01<00:00, 1930.12 examples/s]Done writing 3760 examples in 1377368 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpoo4hrfpq.
Done writing 3760 examples in 1377368 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpjvp4y9us.
Done writing 3760 examples in 1377368 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmppla27eom.
Map: 100%|██████████| 3760/3760 [00:01<00:00, 1926.92 examples/s]Finished processing shard number None of 1.
Map: 100%|██████████| 3760/3760 [00:02<00:00, 1872.64 examples/s]
Done writing 3760 examples in 1377368 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpszdfw5b6.
Finished processing shard number None of 1.
/vast/home/ajherman/transformers/src/transformers/training_args.py:1454: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Map: 100%|██████████| 3760/3760 [00:02<00:00, 1864.33 examples/s]
/vast/home/ajherman/transformers/src/transformers/training_args.py:1454: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Finished processing shard number None of 1.
Map: 100%|██████████| 3760/3760 [00:02<00:00, 1868.57 examples/s]
/vast/home/ajherman/transformers/src/transformers/training_args.py:1454: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Finished processing shard number None of 1.
Map: 100%|██████████| 3760/3760 [00:02<00:00, 1870.94 examples/s]
/vast/home/ajherman/transformers/src/transformers/training_args.py:1454: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/vast/home/ajherman/transformers/ari/gpt2_train.py", line 95, in <module>
    training_args = TrainingArguments(
                    ^^^^^^^^^^^^^^^^^^
  File "<string>", line 126, in __init__
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 1621, in __post_init__
    and (self.device.type != "cuda")
         ^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2121, in device
    return self._setup_devices
           ^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/utils/generic.py", line 59, in __get__
    cached = self.fget(obj)
             ^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2053, in _setup_devices
    self.distributed_state = PartialState(
                             ^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 281, in __init__
    self.set_device()
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 793, in set_device
    torch.cuda.set_device(self.device)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/cuda/__init__.py", line 408, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "/vast/home/ajherman/transformers/ari/gpt2_train.py", line 95, in <module>
    training_args = TrainingArguments(
                    ^^^^^^^^^^^^^^^^^^
  File "<string>", line 126, in __init__
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 1621, in __post_init__
    and (self.device.type != "cuda")
         ^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2121, in device
    return self._setup_devices
           ^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/utils/generic.py", line 59, in __get__
    cached = self.fget(obj)
             ^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2053, in _setup_devices
    self.distributed_state = PartialState(
                             ^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 281, in __init__
    self.set_device()
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 793, in set_device
    torch.cuda.set_device(self.device)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/cuda/__init__.py", line 408, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "/vast/home/ajherman/transformers/ari/gpt2_train.py", line 95, in <module>
    training_args = TrainingArguments(
                    ^^^^^^^^^^^^^^^^^^
  File "<string>", line 126, in __init__
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 1621, in __post_init__
    and (self.device.type != "cuda")
         ^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2121, in device
    return self._setup_devices
           ^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/utils/generic.py", line 59, in __get__
    cached = self.fget(obj)
             ^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2053, in _setup_devices
    self.distributed_state = PartialState(
                             ^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 281, in __init__
    self.set_device()
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 793, in set_device
    torch.cuda.set_device(self.device)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/cuda/__init__.py", line 408, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "/vast/home/ajherman/transformers/ari/gpt2_train.py", line 95, in <module>
    training_args = TrainingArguments(
                    ^^^^^^^^^^^^^^^^^^
  File "<string>", line 126, in __init__
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 1621, in __post_init__
    and (self.device.type != "cuda")
         ^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2121, in device
    return self._setup_devices
           ^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/utils/generic.py", line 59, in __get__
    cached = self.fget(obj)
             ^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2053, in _setup_devices
    self.distributed_state = PartialState(
                             ^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 281, in __init__
    self.set_device()
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 793, in set_device
    torch.cuda.set_device(self.device)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/cuda/__init__.py", line 408, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Map:  68%|██████▊   | 25000/36718 [00:17<00:04, 2584.18 examples/s]Map:  68%|██████▊   | 25000/36718 [00:17<00:04, 2569.82 examples/s]Map: 100%|██████████| 3760/3760 [00:02<00:00, 1904.95 examples/s]Done writing 3760 examples in 1377368 bytes /vast/home/ajherman/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/tmpm0ymq7pv.
Finished processing shard number None of 1.
Map: 100%|██████████| 3760/3760 [00:02<00:00, 1854.28 examples/s]
/vast/home/ajherman/transformers/src/transformers/training_args.py:1454: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/vast/home/ajherman/transformers/ari/gpt2_train.py", line 95, in <module>
    training_args = TrainingArguments(
                    ^^^^^^^^^^^^^^^^^^
  File "<string>", line 126, in __init__
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 1621, in __post_init__
    and (self.device.type != "cuda")
         ^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2121, in device
    return self._setup_devices
           ^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/utils/generic.py", line 59, in __get__
    cached = self.fget(obj)
             ^^^^^^^^^^^^^^
  File "/vast/home/ajherman/transformers/src/transformers/training_args.py", line 2053, in _setup_devices
    self.distributed_state = PartialState(
                             ^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 281, in __init__
    self.set_device()
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/accelerate/state.py", line 793, in set_device
    torch.cuda.set_device(self.device)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/cuda/__init__.py", line 408, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Map:  71%|███████   | 26000/36718 [00:18<00:04, 2553.73 examples/s]Map:  71%|███████   | 26000/36718 [00:18<00:04, 2536.34 examples/s]Map:  74%|███████▎  | 27000/36718 [00:18<00:03, 2487.41 examples/s]Map:  74%|███████▎  | 27000/36718 [00:18<00:03, 2465.47 examples/s]Map:  76%|███████▋  | 28000/36718 [00:19<00:03, 2452.51 examples/s]Map:  76%|███████▋  | 28000/36718 [00:19<00:03, 2431.42 examples/s]Map:  79%|███████▉  | 29000/36718 [00:19<00:03, 2570.01 examples/s]Map:  79%|███████▉  | 29000/36718 [00:19<00:03, 2548.99 examples/s]Map:  82%|████████▏ | 30000/36718 [00:19<00:02, 2584.55 examples/s]Map:  82%|████████▏ | 30000/36718 [00:19<00:02, 2554.79 examples/s]Map:  84%|████████▍ | 31000/36718 [00:20<00:02, 2472.06 examples/s]Map:  84%|████████▍ | 31000/36718 [00:20<00:02, 2446.22 examples/s][2024-05-23 13:13:36,378] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 369367 closing signal SIGTERM
[2024-05-23 13:13:36,378] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 369369 closing signal SIGTERM
[2024-05-23 13:13:36,378] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 369371 closing signal SIGTERM
[2024-05-23 13:13:36,492] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 1 (pid: 369368) of binary: /vast/home/ajherman/miniconda3/envs/transformer/bin/python
Traceback (most recent call last):
  File "/vast/home/ajherman/miniconda3/envs/transformer/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==2.0.1', 'console_scripts', 'torchrun')())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/.local/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
gpt2_train.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-05-23_13:13:36
  host      : cn145
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 369370)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-05-23_13:13:36
  host      : cn145
  rank      : 5 (local_rank: 5)
  exitcode  : 1 (pid: 369372)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-05-23_13:13:36
  host      : cn145
  rank      : 6 (local_rank: 6)
  exitcode  : 1 (pid: 369373)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[4]:
  time      : 2024-05-23_13:13:36
  host      : cn145
  rank      : 7 (local_rank: 7)
  exitcode  : 1 (pid: 369374)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-05-23_13:13:36
  host      : cn145
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 369368)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
